# -- general -------------------------------------------------------------------

# terminal color ajustment
set-option -sa terminal-overrides ",xterm*Tc"
set-option -g status-keys vi

set-option -s escape-time 10              # faster command sequences
set-option -sg repeat-time 600            # increase repeat timeout
set-option -s focus-events on
set-option -g history-limit 5000          # boost history
# set-option -g set-clipboard on            # use system clipboard

# tmux bar at the bottom
set-option -g status-position top

# Reload config file
unbind r
bind-key r source-file ~/.config/tmux/tmux.conf \; display "~/.config/tmux/tmux.conf sourced!"

# Set tmux prefixes: C-a or C-j
set-option -g prefix C-a
set-option -g prefix2 C-b
# unbind C-b # Default prefix.
bind-key C-a send-prefix


# -- display -------------------------------------------------------------------

set-option -g base-index 1    # start windows numbering at 1
setw -g pane-base-index 1     # make pane numbering consistent with windows

setw -g automatic-rename on   # rename window to reflect current program
set -g renumber-windows on    # renumber windows when a window is closed

set -g display-panes-time 800 # slightly longer pane indicators display time
set -g display-time 1000      # slightly longer status messages display time

# Yazi requirements for image preview to work correctly in tmux
# set -g allow-passthrough on
# set -ga update-environment TERM
# set -ga update-environment TERM_PROGRAM

# -- navigation ----------------------------------------------------------------

# Switch windows with Alt+{h,l} or Shift+{left,right}
bind-key -n M-h previous-window
bind-key -n M-l next-window
# bind -n S-Left previous-window
# bind -n S-Right next-window

# # Easily reorder windows with CTRL+SHIFT+Arrow
# bind-key -n C-S-Left swap-window -t -1
# bind-key -n C-S-Right swap-window -t +1

# create session
bind C-c new-session

# find session
bind C-f command-prompt -p find-session 'switch-client -t %%'

# session navigation
bind BTab switch-client -l  # move to last session

# Set easier window split keys
# split current window horizontally in current directory
bind-key '\' split-window -v -c "#{pane_current_path}"
# split current window vertically in current directory
bind-key '|' split-window -h -c "#{pane_current_path}"
# Open panes in current directory
bind-key '"' split-window -v -c "#{pane_current_path}"
bind-key % split-window -h -c "#{pane_current_path}"
# # Set easier window split keys
# bind-key v split-window -h
# bind-key h split-window -v


# Synchronize panes
bind-key e set-window-option synchronize-panes\; display-message "synchronize mode toggled."

# Quit a single session.
# bind-key C-x kill-session
# Kill the tmux server.
bind-key C-x confirm-before -p "kill-session? (y/n)" kill-session

# Extra keybindings for jumping between panes.
# Remember: the oficial keybindins are C-{h,j,k,l} integrated with nvim.
bind-key -r h select-pane -L
bind-key -r j select-pane -D
bind-key -r k select-pane -U
# bind-key -r l select-pane -R
bind > swap-pane -D       # swap current pane with the next one
bind < swap-pane -U       # swap current pane with the previous one

# pane resizing
bind -r H resize-pane -L 2
bind -r J resize-pane -D 2
bind -r K resize-pane -U 2
bind -r L resize-pane -R 2

# window navigation
# bind -r C-h previous-window                             # select previous window
# bind -r C-l next-window                                 # select next window
# bind -r C-S-H swap-window -t -1 \; select-window -t -1  # swap current window with the previous one
# bind -r C-S-L swap-window -t +1 \; select-window -t +1  # swap current window with the next one
bind Tab last-window                                    # move to last active window

# -- copy mode -----------------------------------------------------------------

bind Enter copy-mode # enter copy mode

# copy/past vim style
# set vi-mode
set-window-option -g mode-keys vi
# keybindings
bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T copy-mode-vi C-v send -X rectangle-toggle
bind-key -T copy-mode-vi y send -X copy-selection-and-cancel
bind-key -T copy-mode-vi Escape send -X cancel
bind-key -T copy-mode-vi H send -X start-of-line
bind-key -T copy-mode-vi L send -X end-of-line

# -- buffers -------------------------------------------------------------------

bind b list-buffers     # list paste buffers
bind p paste-buffer -p  # paste from the top paste buffer
bind P choose-buffer    # choose which buffer to paste from

# With this enabled you can use <prefix> C-l to clear the screen.
bind-key C-l send-keys 'C-l'
bind-key l send-keys 'C-l'

set -g mouse on

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'rose-pine/tmux'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @rose_pine_variant 'main' # Options are 'main', 'moon' or 'dawn'

#=====================[ Pine rose bar config ] ========================#
# Status Bar
set -g status-justify centre
# set -g @rose_pine_host 'on' # Enables hostname in the status bar
set -g @rose_pine_date_time '%H:%M' # It accepts the date UNIX command format (man date for info)
# set -g @rose_pine_user 'on' # Turn on the username component in the statusbar
set -g @rose_pine_directory 'on' # Turn on the current folder component in the status bar
# set -g @rose_pine_bar_bg_disable 'on' # Disables background color, for transparent terminal emulators
# # If @rose_pine_bar_bg_disable is set to 'on', uses the provided value to set the background color
# # It can be any of the on tmux (named colors, 256-color set, `default` or hex colors)
# # See more on http://man.openbsd.org/OpenBSD-current/man1/tmux.1#STYLES
# set -g @rose_pine_bar_bg_disabled_color_option 'default'
#
# set -g @rose_pine_only_windows 'on' # Leaves only the window module, for max focus and space
set -g @rose_pine_disable_active_window_menu 'on' # Disables the menu that shows the active window on the left
#
set -g @rose_pine_default_window_behavior 'on' # Forces tmux default window list behaviour
# set -g @rose_pine_show_current_program 'on' # Forces tmux to show the current running program as window name
# set -g @rose_pine_show_pane_directory 'on' # Forces tmux to show the current directory as window name
# # Previously set -g @rose_pine_window_tabs_enabled
# # Example values for these can be:
# set -g @rose_pine_left_separator ' > ' # The strings to use as separators are 1-space padded
# set -g @rose_pine_right_separator ' < ' # Accepts both normal chars & nerdfont icons
# set -g @rose_pine_field_separator ' | ' # Again, 1-space padding, it updates with prefix + I
set -g @rose_pine_window_separator ": #{?window_zoomed_flag,ï€Ž ,}" # Replaces the default `:` between the window number and name
# set -g @rose_pine_window_separator ' - '
# set -g @rose_pine_current_window_text "#W#{?window_zoomed_flag,(z),}" # Changes the default icon to the left of the active window name
# ðŸ”
#
# # These are not padded
# set -g @rose_pine_current_window_text "#W#{?window_zoomed_flag,(z),}" # Changes the default icon to the left of the active window name
# set -g @rose_pine_session_icon 'î­¿' # Changes the default icon to the left of the session name
# set -g @rose_pine_current_window_icon 'î¬£' # Changes the default icon to the left of the active window name
# set -g @rose_pine_folder_icon 'ï“' # Changes the default icon to the left of the current directory folder
# set -g @rose_pine_username_icon 'ï€‡' # Changes the default icon to the right of the hostname
# set -g @rose_pine_hostname_icon 'ó°’‹' # Changes the default icon to the right of the hostname
# set -g @rose_pine_date_time_icon 'ó°ƒ°' # Changes the default icon to the right of the date module
set -g @rose_pine_window_status_separator " | " # Changes the default icon that appears between window names
#
# # Very beta and specific opt-in settings, tested on v3.2a, look at issue #10
# set -g @rose_pine_prioritize_windows 'on' # Disables the right side functionality in a certain window count / terminal width
# set -g @rose_pine_width_to_hide '20' # Specify a terminal width to toggle off most of the right side functionality
# set -g @rose_pine_window_count '5' # Specify a number of windows, if there are more than the number, do the same as width_to_hide
#=====================[ End of Pine Rose bar config ] ========================#

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
